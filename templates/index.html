<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Cluster Visualization</title>
     <link rel="icon" href="../static/images/icon.png">

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <link href="css/scrolling-nav.css" rel="stylesheet">
    <link href="css/style.css" rel="stylesheet">
    <link rel="stylesheet" href="{{url_for('static', filename='css/style.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename='css/scrolling-nav.css')}}">
    <link rel="stylesheet" href="{{url_for('static', filename='vendor/bootstrap/css/bootstrap.min.css')}}">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="{{url_for('static', filename='vendor/dropzone/dropzone.css')}}">

  </head>

  <style>
      /*mudanca do css do layout de cada arquivo dentro do dropzone*/
      .dropzone .dz-preview .dz-image {
           border-radius: 20px;
           overflow: hidden;
           width: 25em;
           /*height: 7em;*/
           padding: 0.2em;
           position: relative;
           display: block;
           z-index: 10;
      }

      .dropzone .dz-preview.dz-file-preview .dz-image {
            border-radius: 10px;
            background: #000;
            background: linear-gradient(to bottom, #eee, #eee);
      }

      .dropzone .dz-preview .dz-details .dz-filename:hover span {
         border: 1px solid transparent;
         background-color: linear-gradient(to bottom, #eee, #eee);
       }

      .dropzone .dz-preview {
         position: relative;
         display: inline-block;
         vertical-align: top;
         margin: 0.2em;
         min-height: 100px;
      }

  </style>

  <body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top">Cluster Visualization</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#about">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#usage">Usage</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#contact">Contact</a>
            </li>
            <!-- <li class="nav-item">
              <a class="nav-link" href="#"><i class="fa fa-sign-in" aria-hidden="true"></i> Login</a>
            </li> -->
          </ul>
        </div>
      </div>
    </nav>

    <section class="bg-primary text-white" id="uploaddataset">
      <div class="container text-center">
        <div class="row" align="center">
          <div class="col-lg-6 col-md-6 col-sm-12 mx-auto">
            <h1><b>Data Set Upload</b></h1>
            <!-- upload vai aqui -->
            <form action="#" class="dropzone dz-clickable" id="dropdataset" method="POST" enctype="multipart/form-data">
              <input type="hidden" name="name" value="dataset" />
              <div class="dz-message" data-dz-message style="color:grey;"><span><b>Drop files</b> or <b>click here</b> to upload</span><p style="font-size:80%;">The files must have a text format</p></div>
            </form>
                <button type="submit" class="btn btn-secondary" style="margin-top: 1em;" id="continueDataset" data-toggle="modal" data-target="#partitionchoice">Continue</button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="container hidden" id="choosePath">
      <div class="container text-center">
        <div class="row" align="center">
        <div class="col-12 mx-auto">
          <h1><b>Partitions to Visualize</b></h1>
          <div class="row" style="margin-top:2em;">
            <div class="col-4"></div>
            <label for="chooseGenerate" style="font-size:150%;"><input id="chooseGenerate" type="radio" name="choosePtoV"></input> Generate Partitions</label>
          </div>
          <div class="row form-check">
            <div class="col-4"></div>
            <div class="col-4 hidden" align="left" id="chooseBorM">
              <label for="chooseBasic"><input id="chooseBasic" class="form-check-input" type="checkbox"></input><a href="#basicUsage"> Basic Algorithms</a></label><br>
              <label for="chooseMocle"><input id="chooseMocle" class="form-check-input" type="checkbox"></input><a href="#mocleUsage"> MOCLE</a></label>
            </div>
          </div>
          <div class="row" align="center" style="margin-top:1em;">
            <div class="col-4"></div>
            <label for="chooseUpload" style="font-size:150%;"><input id="chooseUpload" type="radio" name="choosePtoV"></input> Upload Partitions</label>
          </div>
          <div class="row" style="margin-top:1em;">
            <div class="col-4"></div>
            <div class="col-4" align="center">
              <button type="button" class="btn btn-primary" id="continueChoosePath">Continue</button>
            </div>
          </div>
        </div>
        </div>
      </div>
    </section>

    <!-- only appears when Upload Partition is selected -->
    <section class="bg-primary text-white hidden" id="uploadpartition">
      <div class="container text-center">
        <div class="row" align="center">
        <div class="col-lg-6 col-md-6 col-sm-12 mx-auto">
          <h1><b>Upload Partition</b></h1>
          <form action="#" class="dropzone dz-clickable"  id="droppartition" method="POST" enctype="multipart/form-data">
            <input type="hidden" name="name" value="partition" />
            <div class="dz-message" data-dz-message style="color:grey;"><span><b>Drop files</b> or <b>click here</b> to upload</span><p style="font-size:80%;">The files must have a text format</p></div>
          </form>
              <button type="submit" class="btn btn-secondary" style="margin-top:1em;" id="visOnlyPartitions">Generate Visualization</button>
          </div>
        </div>
      </div>
    </div>
  </section>

    <!-- only appears when Generate Partition, Basic Algorithms and Mocle are selected -->
    <section id="datasetBoth" class="container hidden">
        <h2>Clustering</h2>
        <!-- choose basic -->
        <div class="row" style="margin-top:2em;">
          <div class="col-12">
               <div class="card">
               <div class="card-header">
                 <span><a href="#basicUsage">Basic Algorithms</a></span>
               </div>
               <div class="card-block filter-panel container" style="margin: 0.5em" id="filter-data-basic">
                 <label for="chooseAll"><input type="checkbox" style="font-weight:bold;" id="chooseAll" value="1" onclick="checkAll(this)"> Select All</label>
                 <div id="checkboxDataSet">
                   <label for="singleLink"><input type="checkbox" id="2"> Single Link</label>
                   <label for="averageLink"><input type="checkbox" id="3"> Average Link</label>
                   <label for="centroidLink"><input type="checkbox" id="4"> Centroid Link</label>
                   <label for="completeLink"><input type="checkbox" id="5"> Complete Link</label>
                   <label for="SNN"><input type="checkbox" id="6"> SNN</label>
                   <label for="kMeans"><input type="checkbox" id="7"> KMeans</label>
                </div>
                <div class="col-6">
                  <label for="selMetricBasic"><a href="#distanceUsageBasic">Crossover</a>:</label><br>
                  <select class="form-control" id="selMetricBasic">
                    <option value="E">Euclidean Distance</option>
                    <option value="P">Pearson Correlation</option>
                  </select>
                </div>
                <div class="col-10">
                  <p style="margin-top: 1em;">Cluster Size Interval:</p>
                  <div class="row" style="margin-top: 1em;">
                    <label for="minKBasic" class="col-2 col-form-label">Minimum:</label>
                    <div class="col-2">
                      <input class="form-control" type="number" min="0" value="" id="minKBasic">
                    </div>
                    <label for="maxKBasic" class="col-2 col-form-label">Maximum:</label>
                    <div class="col-2">
                      <input class="form-control" type="number" min="0" value="" id="maxKBasic">
                    </div>
                  </div>
                </div>
               </div>
             </div>
           </div>
        </div>

        <!-- choose mocle -->
        <div class="row" style="margin-top:2em;">
          <div class="col-12">
               <div class="card">
                 <div class="card-header">
                   <span><a href="#mocleUsage">Mocle</a></span>
                 </div>
                 <div class="card-block filter-panel container" style="margin: 0.5em" id="filter-part-mocle">
                   <div class="col-6">
                     <label for="selMetricMocle"><a href="#crossoverUsage">Crossover</a>:</label><br>
                     <select class="form-control" id="selMetricMocle">
                       <option value="M">MCLA</option>
                       <option value="H">HBGF</option>
                     </select>
                   </div>
                   <div class="col-10">
                     <p style="margin-top: 1em;"><a href="#kConsensusUsage">k of the consensus partition</a>:</p>
                     <div class="row" style="margin-top: 1em;">
                       <label for="minKMocle" class="col-2 col-form-label">Minimum:</label>
                       <div class="col-2">
                         <input class="form-control" type="number" min="0" value="" id="minKMocle">
                       </div>
                       <label for="maxKMocle" class="col-2 col-form-label">Maximum:</label>
                       <div class="col-2">
                         <input class="form-control" type="number" min="0" value="" id="maxKMocle">
                       </div>
                     </div>
                   </div>
                   <div class="row col-10" style="margin-top: 1em;">
                     <label for="numGenMocle" class="col-2 col-form-label"><a href="#nGenerationsUsage">Number of Generations</a>:</label>
                     <div class="col-2">
                       <input class="form-control" type="number" min="0" value="1" id="numGenMocle">
                     </div>
                     <label for="nearNeighMocle" class="col-2 col-form-label"><a href="#nNearestNeighborsUsage">Nearest Neighbours</a>:</label>
                     <div class="col-2">
                       <input class="form-control" type="number" min="0" value="1" id="nearNeighMocle">
                     </div>
                   </div>
                 </div>
               </div>
              </div>
          </div>
        <div class="row" style="margin-top:2em;">
          <div class="col-12" align="center">
            <button type="button" class="btn btn-primary" id="visWithAlg">Generate Visualization</button>
          </div>
        </div>
    </section>

    <!-- only appears when Generate Partition and Basic Algorithms are selected -->
    <section id="datasetOnlyBasic" class="container hidden">
        <h2>Clustering</h2>
        <!-- choose basic -->
        <div class="row" style="margin-top:2em;">
          <div class="col-12">
               <div class="card">
               <div class="card-header">
                 <span><a href="#basicUsage">Basic Algorithms</a></span>
               </div>
               <div class="card-block filter-panel container" style="margin: 0.5em" id="filter-data-basic">
                 <label for="chooseAll"><input type="checkbox" style="font-weight:bold;" id="chooseAll" value="1" onclick="checkAll(this)"> Select All</label>
                 <div id="checkboxDataSet">
                   <label for="singleLink"><input type="checkbox" id="2"> Single Link</label>
                   <label for="averageLink"><input type="checkbox" id="3"> Average Link</label>
                   <label for="centroidLink"><input type="checkbox" id="4"> Centroid Link</label>
                   <label for="completeLink"><input type="checkbox" id="5"> Complete Link</label>
                   <label for="SNN"><input type="checkbox" id="6"> SNN</label>
                   <label for="kMeans"><input type="checkbox" id="7"> KMeans</label>
                </div>
                <div class="col-6">
                  <label for="selMetricBasic"><a href="#distanceUsageBasic">Crossover</a>:</label><br>
                  <select class="form-control" id="selMetricBasic">
                    <option value="E">Euclidean Distance</option>
                    <option value="P">Pearson Correlation</option>
                  </select>
                </div>
                <div class="col-10">
                  <p style="margin-top: 1em;">Cluster Size Interval:</p>
                  <div class="row" style="margin-top: 1em;">
                    <label for="minKBasic" class="col-2 col-form-label">Minimum:</label>
                    <div class="col-2">
                      <input class="form-control" type="number" min="0" value="" id="minKBasic">
                    </div>
                    <label for="maxKBasic" class="col-2 col-form-label">Maximum:</label>
                    <div class="col-2">
                      <input class="form-control" type="number" min="0" value="" id="maxKBasic">
                    </div>
                  </div>
                </div>
               </div>
             </div>
           </div>
        </div>
        <div class="row" style="margin-top:2em;">
          <div class="col-12" align="center">
            <button type="button" class="btn btn-primary" id="visOnlyBasic">Generate Visualization</button>
          </div>
        </div>
      </section>

      <!-- only appears when Generate Partition and Mocle are selected -->
      <section class="hidden bg-light" id="datasetOnlyMocle">
        <div class="container">
          <div class="col-lg-6 col-md-6 col-sm-12 mx-auto" align="center">
            <h1><b>Upload Partition</b></h1>
            <form action="#" class="dropzone dz-clickable"  id="droppartitionWithMocle" method="POST" enctype="multipart/form-data">
              <input type="hidden" name="name" value="partition" />
              <div class="dz-message" data-dz-message style="color:grey;"><span><b>Drop files</b> or <b>click here</b> to upload</span><p style="font-size:80%;">The files must have a text format</p></div>
            </form>
          </div>
            <!-- choose mocle -->
            <div class="row" style="margin-top:2em;">
              <div class="col-12">
                   <div class="card">
                     <div class="card-header">
                       <span><a href="#mocleUsage">Mocle</a></span>
                     </div>
                     <div class="card-block filter-panel container" style="margin: 0.5em" id="filter-part-mocle">
                       <div class="col-6">
                         <label for="selMetricMocle"><a href="#crossoverUsage">Crossover</a>:</label><br>
                         <select class="form-control" id="selMetricMocle">
                           <option value="M">MCLA</option>
                           <option value="H">HBGF</option>
                         </select>
                       </div>
                       <div class="col-10">
                         <p style="margin-top: 1em;"><a href="#kConsensusUsage">k of the consensus partition</a>:</p>
                         <div class="row" style="margin-top: 1em;">
                           <label for="minKMocle" class="col-2 col-form-label">Minimum:</label>
                           <div class="col-2">
                             <input class="form-control" type="number" min="0" value="" id="minKMocle">
                           </div>
                           <label for="maxKMocle" class="col-2 col-form-label">Maximum:</label>
                           <div class="col-2">
                             <input class="form-control" type="number" min="0" value="" id="maxKMocle">
                           </div>
                         </div>
                       </div>
                       <div class="row col-10" style="margin-top: 1em;">
                         <label for="numGenMocle" class="col-2 col-form-label"><a href="#nGenerationsUsage">Number of Generations</a>:</label>
                         <div class="col-2">
                           <input class="form-control" type="number" min="0" value="1" id="numGenMocle">
                         </div>
                         <label for="nearNeighMocle" class="col-2 col-form-label"><a href="#nNearestNeighborsUsage">Nearest Neighbours</a>:</label>
                         <div class="col-2">
                           <input class="form-control" type="number" min="0" value="1" id="nearNeighMocle">
                         </div>
                       </div>
                     </div>
                   </div>
                  </div>
              </div>
              <div class="row" style="margin-top:2em;">
                <div class="col-12" align="center">
                  <button type="button" class="btn btn-primary" id="visOnlyMocle">Generate Visualization</button>
                </div>
              </div>
          </div>
    </section>

     <section class="container hidden" id="loading">
       <div align="center">
         <img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Loading_icon.gif" alt="Loading"></img>
       </div>
     </section>

     <div id="cViz" class="hidden container">
       <div id="clustersTable" style="max-height: 400px; overflow: auto;"></div>
     </div>

    <section id="about">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <h2>About</h2>
            <p class="lead">The tool</p>
            <p style="text-align: justify;">Ensemble methods for clustering take a collection
                of input partitions, produced for the same data set, and generate
                an ensemble partition that tries to preserve the information
                carried in this collective. Acceptance of the resulting partition(s)
                by decision makers can be a problem, due to the inherent
                complexity of ensemble techniques, and the associated lack of
                intuition on how a consensus has been derived from the original
                set of input partitions. This problem is exacerbated in multi-
                objective ensemble techniques, which generate a set of non-
                dominated consensus partitions. In this context, the selection of
                a final candidate clustering may require additional insight into
                the relationships between non-dominated output partitions.
                CVis has been developed as a generaluploadpartition
                tool to provide insight into the relationship between any set
                of partitions of a given data set. In particular,
                the tool facilitates the visual analysis of the level of support
                identified for individual consensus clusters, which is helpful in
                explaining final solutions to a decision maker.</p>
            <p class="lead">Citing CVis</p>
            <p>If you publish material using CVis, please cite the following
            reference:</p>
            <p>Faceli, K., Sakata, T., and Handl, J. CVis - towards a
            novel visualization tool to explore the relationship between input
            and output partitions in multi-objective clustering ensembles. (2016).
            <p class="lead">Citing MOCLE</p>
            <p>If you publish material using MOCLE, please cite the following reference:</p>
            <p>Katti Faceli, Marcílio C. P. de Souto, D. S. A. de Araujo, André C. P. L. F. de Carvalho.
              Multi-objective clustering ensemble for gene expression data analysis. Neurocomputing 72 (13-15): 2763-2774 (2009).
              <a href="http://www.sciencedirect.com/science/article/pii/S0925231209001167">DOI: 10.1016</a></p>
            </p>
          </div>
        </div>
      </div>
    </section>

    <section id="usage" class="bg-light">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <h2>Usage</h2>
            <h5>You can read below the definition of the algorithms' parameters:</h5>
          </div>
        </div>
        <div class="col-lg-8 mx-auto">
          <h3 style="margin-top:1em;"><b id="basicUsage">Basic Algorithms</b></h4>
          <h5 id="distanceUsageBasic">Distance</h5>
          <ul>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> Euclidean Distance </div></li>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> Pearson Correlation </div></li>
          </ul>
          <h5 id="datasetUsageBasic"> Data set </h5>
             <ul>
               <li>Data set in a text file format, where the first row contains columns labels and first column indicates the objects IDs.</li>
             </ul>
          <h5 id="algorithmsUsageBasic">Algorithms</h5>
          <ul>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> Single Link - Based on grouping clusters in bottom-up fashion (agglomerative clustering), at each step combining two clusters that contain the closest pair of elements not yet belonging to the same cluster as each other.</div></li>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> Average Link- </div></li>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> Centroid Link - </div></li>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> Complete Link - </div></li>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> Shared Near Neighbors - </div></li>
            <li><div class="mdl-card__subtitle-text mdl-color-text--black"> K-Means - Aims to partition n observations into k clusters in which each observation belongs to the cluster with the nearest mean, serving as a prototype of the cluster.</div></li>
          </ul>

          <h3 style="margin-top:1em;"><b id="mocleUsage">Mocle</b></h3>
          <h5 id="crossoverUsage"> Crossover </h5>
            <ul>
              <li><div class="mdl-card__subtitle-text mdl-color-text--black"> MCLA - Meta-CLustering Algorithm as described in (1) </div></li>
              <li><div class="mdl-card__subtitle-text mdl-color-text--black"> HBGF - Hybrid Bipartite Graph Formulation as described in (3) </div></li>
            </ul>
           <h5 id="kConsensusUsage"> k of the consensus partition</h5>
              <ul>
                <li>Interval of k for choosing the number of clusters for the consensus partition when applying the crossover. The maximum number of clusters in each consensus partition is randomly  choosen  within this interval.</li>
              </ul>
           <h5 id="datasetUsageMocle"> Data set </h5>
              <ul>
                <li>Data set in a text file format, where the first row contains columns labels and first column indicates the objects IDs.</li>
              </ul>
            <h5 id="initialPartitionsUsage"> Initial Partitions </h5>
              <ul>
                <li>Initial partitions represented as text files. Each file represents one partition and must contain two columns: the first column denotes the IDs of the objects (as in the data set) and the second column represents the labels of the clusters.</li>
              </ul>
            <h5 id="nGenerationsUsage"> Number of Generations </h5>
              <ul>
                <li>Maximum number of generations for running the genetic algorithm.</li>
              </ul>
            <h5 id="nNearestNeighborsUsage"> Nearest Neighbors (%) </h5>
               <ul>
                 <li>Percentage of the data set size used to define the number of nearest neighbor objects for calculating the connectivity.</li>
               </ul>
        </div>
      </div>
    </section>

    <section id="contact">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <h2>Contact</h2>
            <p class="lead"><a href="http://lattes.cnpq.br/4451540730749377">Katti Faceli</a> (katti <i>at </i>ufscar <i>dot</i> br)</p>
            <p class="lead"><a href="http://lattes.cnpq.br/3560505262283874">Tiemi C. Sakata</a> (tiemi <i>at</i> ufscar <i>dot</i> br)</p>
            <p class="lead"><a href="http://personalpages.manchester.ac.uk/mbs/julia.handl/">Julia Handl</a> (Julia <i>dot</i> Handl <i>at</i> manchester <i>dot</i> ac <i>dot</i> uk)</p>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="py-5 bg-dark">
      <div class="container">
        <p class="m-0 text-center text-white">The opinions, hypothesis,
        conclusions or recommendations contained in this material are the responsibility of the author(s) and do not necessarily reflect FAPESP's vision. (As opiniões, hipóteses e conclusões ou recomendações expressas neste material são de responsabilidade do autor(es) e não
        necessariamente refletem a visão da FAPESP)</p>
      </div>
      <!-- /.container -->
    </footer>

    <!-- Modal warning -->
    <div id="aviso_modal" class="modal fade" role="dialog" tabindex="-1">
      <div class="modal-dialog">
        <!-- Modal content-->
        <div class="modal-content">
          <div class="modal-header">
            <h4 class="modal-title">Required</h4>
          </div>
          <div class="modal-body" style="background-color:tomato;">
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" id="cleanbody" data-dismiss="modal">OK</button>
          </div>
        </div>
      </div>
    </div>

      <!-- Bootstrap core JavaScript -->
      <script type="text/javascript" src="{{url_for('static', filename='vendor/jquery/jquery.min.js')}}"></script>
      <script type="text/javascript" src="{{url_for('static', filename='vendor/popper/popper.min.js')}}"></script>
      <script type="text/javascript" src="{{url_for('static', filename='vendor/bootstrap/js/bootstrap.min.js')}}"></script>

      <!-- Plugin JavaScript -->
      <script type="text/javascript" src="{{url_for('static', filename='vendor/jquery-easing/jquery.easing.min.js')}}"></script>

      <!-- Custom JavaScript for this theme -->
      <script type="text/javascript" src="{{url_for('static', filename='js/scrolling-nav.js')}}"></script>

      <script src="{{url_for('static', filename='vendor/dropzone/dropzone.js')}}"></script>
      <!-- <script src="{{url_for('static', filename='vendor/dropzone/dropzone.min.js')}}"></script> -->


      <!-- <link rel="stylesheet" type="text/css" href="http://akottr.github.io/css/reset.css" /> -->

      <!-- esse css deixa a página feia -->
      <!-- <link rel="stylesheet" type="text/css" href="http://akottr.github.io/css/akottr.css" /> -->
      <link rel="stylesheet" href="{{url_for('static', filename='css/dragtable.css')}}">

      <!-- <script src="{{url_for('static', filename='js/d3.v4.js')}}"></script> -->
      <script src="{{url_for('static', filename='js/queue.js')}}"></script>
      <script src="{{url_for('static', filename='js/d3-queue.v3.js')}}"></script>
      <script src="{{url_for('static', filename='js/colorbrewer.v1.js')}}"></script>
      <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/1.6.20/topojson.min.js"></script> -->
      <script src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.10.2/jquery-ui.min.js"></script>
      <script src="{{url_for('static', filename='js/jquery.dragtable.js')}}"></script>
      <!-- cViz table -->
      <script type="text/javascript" src="{{url_for('static', filename='js/cViz_core.js')}}"></script>
      <script type="text/javascript" src="{{url_for('static', filename='js/cViz_main.js')}}"></script>
      <script type="text/javascript" src="{{url_for('static', filename='js/cViz_clustersTable.js')}}"></script>

    <script type="text/javascript">
    var partitionSelected = false;

      $(document).ready(function(){
        $("input").val("");
        $(".hidden").hide();
        $("#continueDataset").prop("disabled",true);
        $("#visOnlyPartitions").prop("disabled",true);
        $("#visOnlyMocle").prop("disabled",true);
      });

      Dropzone.autoDiscover = false;

      //dataset with algorithms dropzone
        var myDropzone1 = new Dropzone(document.getElementById("dropdataset"), {
          acceptedFiles: '.txt',
          addRemoveLinks: true,

          thumbnailWidth: 500,
          maxFiles: 1,
          autoProcessQueue: false,

          init: function() {
            this.on("sending", function(file, xhr, formData){
                if($('#chooseUpload:checked').length == 1 || $('#chooseMocle:checked').length == 1 && $('#chooseBasic:checked').length == 0){
                  formData.append("partition", "yes");
                }
                else{
                  formData.append("partition", "no");
                  //dados que são utilizados para rodar o clustering
                  formData.append("basicSelected", "yes");
                  formData.append("tipoDistBasic", $("#selMetricBasic").val());
                  if($('#chooseAll:checked').length == 1 && $('#checkboxDataSet input:checked').length == 6){
                    formData.append("alg", "1");
                  }
                  else{
                    var alg = $('#checkboxDataSet input:checked').map(function() {
                      return this.id;
                    }).get();
                    formData.append("alg", alg);
                  }
                  formData.append("minKBasic", $("#minKBasic").val());
                  formData.append("maxKBasic", $("#maxKBasic").val());

                  //dados que são utilizados para rodar o mocle
                  if($('#chooseMocle:checked').length == 1){
                    formData.append("mocleSelected", "yes");
                    formData.append("tipoDistMocle", $("#selMetricMocle").val());
                    formData.append("numGen", $("#numGenMocle").val());
                    formData.append("nearNeigh", $("#nearNeighMocle").val());
                    formData.append("minKMocle", $("#minKMocle").val());
                    formData.append("maxKMocle", $("#maxKMocle").val());
                  }

                  formData.append("name", "dataset");
                }
            }),
            this.on("addedfile", function(event) {
              $("#continueDataset").prop("disabled",false);
            }),
            this.on("removedfile", function(event) {
              $("#continueDataset").prop("disabled",true);
            }),
            this.on("processing", function(event){
              $('#loading').show();
              $('#loading')[0].scrollIntoView({
                  behavior: "smooth", // or "auto" or "instant"
                  block: "start" // or "end"
                });
            });
          }
        });

        //partition only dropzone
        var myDropzone2 = new Dropzone(document.getElementById("droppartition"), {
          acceptedFiles: '.clu',
          addRemoveLinks: true,
          thumbnailWidth: 500,
          autoProcessQueue: false,

          init: function() {
            this.on("sending", function(file, xhr, formData){
              formData.append('qtofdata', myDropzone2.getAcceptedFiles().length);
              formData.append('datasetfile', myDropzone1.getAcceptedFiles()[0]);
              formData.append("name", "partition");
              formData.append("mocleSelected", "no");
              myDropzone1.processQueue();
            }),
            this.on("addedfile", function(event) {
              $("#visOnlyPartitions").prop("disabled",false);
            }),
            this.on("removedfile", function(event) {
              $("#visOnlyPartitions").prop("disabled",true);
            }),
            this.on("processing", function(event){
              $('#loading').show();
              $('#loading')[0].scrollIntoView({
                behavior: "smooth", // or "auto" or "instant"
                block: "start" // or "end"
              });
            });
          }
        });

        //partition with mocle dropzone
        var myDropzone3 = new Dropzone(document.getElementById("droppartitionWithMocle"), {
          acceptedFiles: '.clu',
          addRemoveLinks: true,
          thumbnailWidth: 500,
          autoProcessQueue: false,
          init: function() {
            this.on("sending", function(file, xhr, formData){
              formData.append('qtofdata', myDropzone3.getAcceptedFiles().length);
              formData.append('datasetfile', myDropzone1.getAcceptedFiles()[0]);
              formData.append("name", "partition");
              formData.append("mocleSelected", "yes");
              formData.append("tipoDistMocle", $("#selMetricMocle").val());
              formData.append("numGen", $("#numGenMocle").val());
              formData.append("nearNeigh", $("#nearNeighMocle").val());
              formData.append("minKMocle", $("#minKMocle").val());
              formData.append("maxKMocle", $("#maxKMocle").val());
              myDropzone1.processQueue();
            }),
            this.on("addedfile", function(event) {
              $("#visOnlyMocle").prop("disabled",false);
            }),
            this.on("removedfile", function(event) {
              $("#visOnlyMocle").prop("disabled",true);
            }),
            this.on("processing", function(event){
              $('#loading').show();
              $('#loading')[0].scrollIntoView({
                behavior: "smooth", // or "auto" or "instant"
                block: "start" // or "end"
              });
            });
          }
        });

        $("#continueDataset").click(function(){
          $('#choosePath').show();
            $("#choosePath")[0].scrollIntoView({
                behavior: "smooth", // or "auto" or "instant"
                block: "start" // or "end"
              });
        });

        $("#chooseGenerate").change(function(){
          if($(this).is(':checked'))
            $("#chooseBorM").show("slow");
        });
        $("#chooseUpload").change(function(){
          if($(this).is(':checked'))
            $("#chooseBorM").hide("slow");
        });

        $("#continueChoosePath").click(function(){
          var error = false;
          if($("#chooseGenerate").prop('checked') == false && $("#chooseUpload").prop('checked') == false){
            $('#aviso_modal .modal-body').append('<p>You should choose between Generate or Upload partitions to continue.</p>');
            error = true;
          }
          else if($("#chooseGenerate").is(':checked')){
            if($("#chooseBasic").is(':checked') && $("#chooseMocle").is(':checked')){
              $('#datasetBoth').show();
                $("#datasetBoth")[0].scrollIntoView({
                    behavior: "smooth", // or "auto" or "instant"
                    block: "start" // or "end"
                  });
            }
            else if($("#chooseBasic").is(':checked')){
              $('#datasetOnlyBasic').show();
                $("#datasetOnlyBasic")[0].scrollIntoView({
                    behavior: "smooth", // or "auto" or "instant"
                    block: "start" // or "end"
                  });
            }
            else if($("#chooseMocle").is(':checked')){
              $('#datasetOnlyMocle').show();
                $("#datasetOnlyMocle")[0].scrollIntoView({
                    behavior: "smooth", // or "auto" or "instant"
                    block: "start" // or "end"
                  });
            }
            else{
              $('#aviso_modal .modal-body').append('<p>You should choose at least a algorithm to generate partitions.</p>');
              error = true;
            }
          }
          else if($("#chooseUpload").is(':checked')){
            $('#uploadpartition').show();
              $("#uploadpartition")[0].scrollIntoView({
                  behavior: "smooth", // or "auto" or "instant"
                  block: "start" // or "end"
                });
          }
          if(error){
            $('#aviso_modal').modal("show");
          }
          else{
            $("#continueChoosePath").prop("disabled",true);
          }
        });

        function checkAll(bx){
          var cbs = $('#checkboxDataSet input');
          for(var i=0; i < cbs.length; i++) {
            if(cbs[i].type == 'checkbox') {
              cbs[i].checked = bx.checked;
            }
          }
        }

        $("#visWithAlg").click(function(){
          error = false;
          $('#chooseBasic').prop('checked', true);
          $('#chooseMocle').prop('checked', true);
          if($('#checkboxDataSet input:checked').length == 0){
            $('#aviso_modal .modal-body').append('<p>You should choose at least a Basic Algorithm to generate partitions.</p>');
            error = true;
          }
          if($('#minKBasic').val() == "" || $('#maxKBasic').val() == "" || $('#minKMocle').val() == "" || $('#maxKMocle').val() == ""){
            $('#aviso_modal .modal-body').append('<p>Both minimum and maximum cluster size interval values are required.</p>');
            error = true;
          }
          else{
            if($('#minKBasic').val() > $('#maxKBasic').val() || $('#minKMocle').val() > $('#maxKMocle').val()){
              $('#aviso_modal .modal-body').append('<p>Maximum cluster size must be higher than minimum cluster size.</p>');
              error = true;
            }
          }
          if($('#numGenMocle').val() == ""){
            $('#aviso_modal .modal-body').append('<p>You should choose a Number of Generations.</p>');
            error = true;
          }
          if($('#nearNeighMocle').val() == ""){
            $('#aviso_modal .modal-body').append('<p>You should choose a percentage for Nearest Neighbours.</p>');
            error = true;
          }
          if(error){
            $('#aviso_modal').modal("show");
          }
          else{
            myDropzone1.processQueue();
            $("#visWithAlg").prop("disabled",true);
          }
        });

        $("#visOnlyBasic").click(function(){
          error = false;
          $('#chooseBasic').prop('checked', true);
          if($('#checkboxDataSet:checked').length == 0){
            $('#aviso_modal .modal-body').append('<p>You should choose at least a Basic Algorithm to generate partitions.</p>');
            error = true;
          }
          if($('#minKBasic').val() == "" || $('#maxKBasic').val() == ""){
            $('#aviso_modal .modal-body').append('<p>Both minimum and maximum cluster size interval values are required.</p>');
            error = true;
          }
          else{
            if($('#minKBasic').val() > $('#maxKBasic').val()){
              $('#aviso_modal .modal-body').append('<p>Maximum cluster size must be higher than minimum cluster size.</p>');
              error = true;
            }
          }
          if(error){
            $('#aviso_modal').modal("show");
          }
          else{
            myDropzone1.processQueue();
            $("#visOnlyBasic").prop("disabled",true);
          }
        });

        $("#visOnlyPartition").click(function(){
          myDropzone2.processQueue();
        });

        $("#visOnlyMocle").click(function(){
          $('#chooseMocle').prop('checked', true);
          if($('#minKMocle').val() == "" || $('#maxKMocle').val() == ""){
            $('#aviso_modal .modal-body').append('<p>Both minimum and maximum cluster size interval values are required.</p>');
            error = true;
          }
          else{
            if($('#minKMocle').val() > $('#maxKMocle').val()){
              $('#aviso_modal .modal-body').append('<p>Maximum cluster size must be higher than minimum cluster size.</p>');
              error = true;
            }
          }
          if($('#numGenMocle').val() == ""){
            $('#aviso_modal .modal-body').append('<p>You should choose a Number of Generations.</p>');
            error = true;
          }
          if($('#nearNeighMocle').val() == ""){
            $('#aviso_modal .modal-body').append('<p>You should choose a percentage for Nearest Neighbours.</p>');
            error = true;
          }
          if(error){
            $('#aviso_modal').modal("show");
          }
          else{
            myDropzone3.processQueue();
            $("#visOnlyMocle").prop("disabled",true);
          }
        });

        //isso faz com que carreguem mais de 2 arquivos por vez
        myDropzone2.on('success', myDropzone2.processQueue.bind(myDropzone2));
        myDropzone3.on('success', myDropzone3.processQueue.bind(myDropzone3));

        $("#cleanbody").click(function(){
          $("#aviso_modal .modal-body").empty();
        });

    </script>

  </body>
</html>
